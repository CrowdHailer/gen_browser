<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Contrary</title>
</head>
<body>
  <input type="text" id="input" placeholder="Enter text here">
  <button onclick="sendToFlipper()">Send to Flipper</button>
  <hr>
  <div id="output"></div>
  <script type="text/javascript" src="/_gen_browser/page.js"></script>
  <script type="text/javascript">
    var $input = document.getElementById('input')
    var $output = document.getElementById('output')

    var client = new GenBrowser({
      init: function(state){
        console.log('Page started', state)
        return state
      },
      handle_info: function(message, state){
        console.log('Message received', message)
        $output.textContent = message.text
        return state
      }
    })

    function sendToFlipper(){
      client.send(client.state.flipper, {
        text: $input.value,
        sender: client.address
      })
      $input.value = ''
    }
  </script>
</body>
</html>
